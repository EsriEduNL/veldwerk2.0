<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="stylesheet" href="css/bootstrap.min.css">

        <!--<link rel="stylesheet" href="css/bootstrap-theme.min.css">-->
        <link rel="stylesheet" href="css/bootstrap-theme.css">
        <link rel="stylesheet" href="//js.arcgis.com/3.11/dgrid/css/skins/claro.css">
        <link rel="stylesheet" href="//js.arcgis.com/3.11/dijit/themes/claro/claro.css">
        <link rel="stylesheet" href="//js.arcgis.com/3.11/esri/css/esri.css">
        <link rel="stylesheet" href="css/main.css">

        <script src="js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>
    </head>
    <body class="claro">
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
    <div class="navbar navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#"><img src="img/logo_esri_nederland.png" alt="Esri Nederland" height="30"/></a>
        </div>
        <div class="navbar-collapse collapse">
          Mooi menu he
        </div><!--/.navbar-collapse -->
      </div><!-- end container -->
      
      <div class="sub-header">
        <div class="container">
          <div class="row">
            <div class="col-xs-9">
              <p>Veldwerk 2.0</p>
            </div>
            <div class="col-xs-3">
              <p class="pull-right"><a href="#" class="user-toggle-actions" id="loginLink"><span class="glyphicon glyphicon-user"></span> <span class="hidden-xs" id="userNameLabel">Peter Henk</span> <span class="glyphicon glyphicon-chevron-down"></span></a></p>
            </div>
          </div>
        </div><!-- end container -->
      </div><!-- end row sub-header -->
    
    </div><!-- end navbar -->
	
    <div class="container container-login">
      <div class="row row-login">
        <div class="col-sm-2"></div>
        <div class="col-sm-8 col-login">
          <h3>Login</h3>
          <p>Deze Veldwerk 2.0 applicatie is bedoelt voor docenten die deelnemen aan het <a href="">ArcGIS Veldwerk</a> programma.</p>
          <form role="form">
            <div class="form-group">
              <label for="username">Gebruikersnaam</label>
              <input type="text" name="username" class="form-control"/>
            </div>
            
            <div class="form-group">
              <label for="password">Wachtwoord</label>
              <input type="password" name="password"class="form-control" />
            </div>
            <button type="submit" class="btn btn-primary">Inloggen</button>
          </form>
        </div>
      </div>
    </div>
    
    <!-- Main jumbotron for a primary marketing message or call to action -->
  <section id="section-introduction" class="section-blue">
      <div class="container">
        <h2>Veldwerk kan moderner!</h2>
        <p>This is a template for a simple marketing or informational website. It includes a large callout called a jumbotron and three supporting pieces of content. Use it as a starting point to create something more unique.</p>
        <p><a class="btn btn-primary btn-lg" role="button">Learn more &raquo;</a></p>
      </div>
  </section>
  
  <section id="section-workflow" class="section-white">	
    <div class="container">
      <div class="row">
        <div class="col-xs-12">
          <h3>@TODO: beschrijf (visueel) de workflow voor docent</h3>
        </div>
        <div class="col-xs-12">
          <p>tekst</p>
        </div>
      </div>
    </div>
  </section>
   
   <section id="section-webmapp-selection" class="section-grey"> 
    <div class="container container-webmap-selection">
      <div class="row">
        <div class="col-xs-12">
          <h3>Webmapp selecteren</h3>
        </div><!-- end col-xs-12 -->
        <div class="col-xs-12">
          <p>Eerder heeft u een ArcGIS Online webmapp gemaakt met daarin (o.a.) de vragen voor uw leerlingen. Selecteer die webmapp hieronder en ga door naar de volgende stap.</p>
        </div>
        <div class="col-sm-6 col-md-4">
          <div class="thumbnail">
            <img src="http://placehold.it/200x133" alt="..." id="map1Image">
            <div class="caption">
              <h3 id="map1Title">Titel kaart 1 kan best lang zijn</h3>
              <p id="map1Desc">wat details (wanneer aangemaakt, wie is eigenaar oid)</p>
              <p><a href="#" class="btn btn-primary" role="button">Geselecteerd</a></p>
            </div>
          </div>
        </div>
        <div class="col-sm-6 col-md-4">
          <div class="thumbnail">
            <img src="http://placehold.it/200x133" alt="...">
            <div class="caption">
              <h3>Thumbnail label</h3>
              <p>...</p>
              <p><a href="#" class="btn btn-default" role="button">Selecteer</a></p>
            </div>
          </div>
        </div>
        <div class="col-sm-6 col-md-4">
          <div class="thumbnail">
            <img src="http://placehold.it/200x133" alt="...">
            <div class="caption">
              <h3>Thumbnail label</h3>
              <p>...</p>
              <p><a href="#" class="btn btn-default" role="button">Selecteer</a></p>
            </div>
          </div>
        </div>
      </div><!-- end row -->
    </div><!-- end container webmap-selection -->
  </section><!-- end section webmap-selection -->  
  
  
  <section id="section-define-users" class="section-white">
    <div class="container">
      <div class="row">
        <div class="col-xs-12">
          <h3>Leerlingen indelen</h3>
        </div><!-- end col-xs-12 -->
      </div><!-- end row -->
      <div class="row">
        <div class="col-xs-12">
          <p>In deze stap gaan we bepalen welke leerlingen toegang krijgen tot de webmapp van het veldwerk Ã©n delen we de leerlingen in groepjes in (tenzij u uiteraard kiest voor een individueel veldwerk).</p>
        </div>
      </div>
    </div>
  </section>
  
  <section id="section-result-review" class="section-blue">
    <div class="container">
      <div class="row">
        <div class="col-xs-12">
          <h3>Controle</h3>
        </div><!-- end col-xs-12 -->
      </div><!-- end row -->
      <div class="row">
        <div class="col-xs-12">
          <p>Nu alle voorgaande stappen zijn doorlopen kunnen we gaan testen of alles werkt zoals verwacht.</p>
        </div>
      </div>
    </div>
  </section>
  
  <section id="section-footer">  
    <div class="container">
      <hr>

      <footer>
        <p>&copy; Esri Nederland, 2014</p>
      </footer>
    </div> <!-- /container --> 
  </section>       
            
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.11.1.min.js"><\/script>')</script>

        <script src="js/vendor/bootstrap.min.js"></script>
		<script>
        //async is a new dojoConfig option. The default value of false will load all the Dojo base modules
        //here we set it to true to take advantage of the asynchronous nature of dojo and the the base modules
        //are not automatically loaded.
        var dojoConfig = { async: true, paths: { js: location.pathname.replace(/\/[^/]+$/, "") + "/js" } };
        
    </script>
    <script src="//js.arcgis.com/3.11/"></script>
    <script>
        //require function accepts an array of module ids and a function. The modules are provided as return variables passed as arguments to the function. This replaces the dojo.requires statements.
        require([
          
          "dojo/ready",
          "dojo/dom",
          
          "dojo/on",
          
          "js/VeldWerkCalls",

        ], function (
          
          ready,
          dom,
          
          on,
          
          VeldWerkCalls
        ) {
           
            var vCalls;

            ready(function () {


                dom.byId('userNameLabel').innerHTML = 'Inloggen';
                //search when enter key is pressed or button is clicked
                on(dom.byId('loginLink'), 'click', GetWebMap);
                //on(dom.byId('btnLayer'), 'click', GetLayer);
               

                vCalls = new VeldWerkCalls();

              
            });

            function GetWebMap()
            {
                LogMessage("Start getting info");
                //getfeatureservice item information

                //var die = VeldWerkCalls.getHello();
                
                var die = vCalls.getHello();
                LogMessage("hello: " + die);


                var url = vCalls.getSla();
                LogMessage("sla:" + url);

                vCalls.signIn().then(function (loggedInUser) {
                    LogMessage("Then");
                    var userString = loggedInUser.fullName + " {" + loggedInUser.portal.name + "}";
                    //setting username 
                    dom.byId('userNameLabel').innerHTML = userString;
                    //getting webmaps for this user
                    vCalls.getWebMapsForUser().then(function (response) {
                        LogMessage("Aantal webmaps found: " + response.total);
                        if (response.total > 0)
                        {
                            var firstWebMap = response.results[0];
                            var tUrl = firstWebMap.thumbnailUrl || '';
                            var img = dom.byId('map1Image');
                            img.src=tUrl;
                            dom.byId('map1Title').innerHTML = firstWebMap.title;
                            
                            var webMapid = firstWebMap.id;
                            LogMessage("now using webmap id: " + webMapid + " (" + firstWebMap.title + ")");
                            //dom.byId('txtWebMapId').value = webMapid;
                        }

                    });
                });



            }


            function GetLayer()
            {
                var webMapID = dom.byId('txtWebMapId').value;
                vCalls.getLayersForWebMap(webMapID).then(function (resonse) {


                });
            }



            function LogMessage(msg)
            {
                //var logTxt = dom.byId('txtContent')
                //var txt = logTxt.value;
                var d  = new Date();
                var newtxt = d.toLocaleTimeString()+'-'+ msg;// + '\r\n' + txt;
                console.log(newtxt);//logTxt.value = newtxt;
            }



        });
    </script>
        <script src="js/main.js"></script>
		
        <!-- google web font -->
        <script type="text/javascript">
		WebFontConfig = {
		  google: { families: [ 'Open+Sans:400italic,400,300,600,700:latin' ] }
		};
		(function() {
		  var wf = document.createElement('script');
		  wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
			'://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
		  wf.type = 'text/javascript';
		  wf.async = 'true';
		  var s = document.getElementsByTagName('script')[0];
		  s.parentNode.insertBefore(wf, s);
		})(); </script>
        
        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <script>
            (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
            function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
            e=o.createElement(i);r=o.getElementsByTagName(i)[0];
            e.src='//www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
            ga('create','UA-XXXXX-X');ga('send','pageview');
        </script>
    </body>
</html>
